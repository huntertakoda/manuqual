create view tableau_manufacturing_metrics as
select 
    pr.run_id,
    pr.product_id,
    pr.machine_id,
    pr.operator_id,
    pr.start_time,
    pr.end_time,
    pr.target_quantity,
    pr.actual_quantity,
    pr.status,
    qc.check_id,
    qc.pass_fail,
    d.defect_type,
    d.severity,
    d.rework_cost,
    mm.maintenance_type,
    mm.cost as maintenance_cost,
    -- calculated fields
    (pr.actual_quantity/pr.target_quantity * 100) as yield_percentage,
    case when qc.pass_fail = 1 then 1 else 0 end as passed_check
from production_runs pr
left join quality_checks qc on pr.run_id = qc.run_id
left join defects d on qc.check_id = d.check_id
left join machine_maintenance mm on pr.machine_id = mm.machine_id
;

select *
from tableau_manufacturing_metrics
;
